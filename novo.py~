import pandas as pd
import requests
import io

# URL fornecido
url_resgate = "https://www.tesourodireto.com.br/documents/d/guest/rendimento-resgatar-csv?download=true"

# Tente fazer o download do arquivo
try:
    response = requests.get(url_resgate)
    response.raise_for_status()  # Levanta um erro se a requisição falhar

    # Use io.StringIO para ler o conteúdo do texto
    s_resgate = io.StringIO(response.text)

    # Leia o CSV com pandas, usando o separador correto
    df_resgate = pd.read_csv(s_resgate, sep=';', decimal=',')

    # Imprima as primeiras linhas para verificar se deu certo
    print(df_resgate.head())

except requests.exceptions.RequestException as e:
    print(f"Erro ao baixar o arquivo: {e}")
except Exception as e:
    print(f"Ocorreu um erro: {e}")
